// Copyright 2013 The Flutter Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

import 'package:test/test.dart';
import 'package:vector_graphics_compiler/src/geometry/matrix.dart';
import 'package:vector_graphics_compiler/src/paint.dart';
import 'package:vector_graphics_compiler/src/svg/node.dart';
import 'package:vector_graphics_compiler/src/svg/opacity_peephole.dart';
import 'package:vector_graphics_compiler/src/svg/parser.dart';
import 'package:vector_graphics_compiler/src/svg/resolver.dart';

import 'helpers.dart';

Future<Node> parseAndResolve(String source) async {
  final Node node = parseToNodeTree(source);
  final ResolvingVisitor visitor = ResolvingVisitor();
  return node.accept(visitor, AffineMatrix.identity);
}

void main() {
  test('Applies opacity to single child path', () async {
    final Node node = await parseAndResolve('''
<svg viewBox="0 0 200 200">
  <g opacity="0.5">
    <rect x="0" y="0" width="10" height="10" fill="white" />
  </g>
</svg>''');

    final OpacityPeepholeOptimizer visitor = OpacityPeepholeOptimizer();
    final Node newNode = visitor.apply(node);
    final ResolvedPathNode pathNode =
        queryChildren<ResolvedPathNode>(newNode).single;

    expect(pathNode.paint.fill?.color, const Color(0x7fffffff));
  });

  test('Applies opacity and blend mode to single child path', () async {
    final Node node = await parseAndResolve('''
<svg viewBox="0 0 200 200">
  <g opacity="0.5" style="mix-blend-mode:color-burn">
    <rect x="0" y="0" width="10" height="10" fill="white" />
  </g>
</svg>''');

    final OpacityPeepholeOptimizer visitor = OpacityPeepholeOptimizer();
    final Node newNode = visitor.apply(node);
    final ResolvedPathNode pathNode =
        queryChildren<ResolvedPathNode>(newNode).single;

    expect(pathNode.paint.fill?.color, const Color(0x7fffffff));
    expect(pathNode.paint.blendMode, BlendMode.colorBurn);
  });

  test('Applies opacity to non-overlapping child paths', () async {
    final Node node = await parseAndResolve('''
<svg viewBox="0 0 200 200">
  <g opacity="0.5">
    <rect x="0" y="0" width="10" height="10" fill="white" />
    <rect x="30" y="40" width="10" height="10" fill="white" />
  </g>
</svg>''');

    final OpacityPeepholeOptimizer visitor = OpacityPeepholeOptimizer();
    final Node newNode = visitor.apply(node);
    final List<ResolvedPathNode> pathNodes =
        queryChildren<ResolvedPathNode>(newNode);

    expect(pathNodes[0].paint.fill?.color, const Color(0x7fffffff));
    expect(pathNodes[1].paint.fill?.color, const Color(0x7fffffff));
  });

  test(
      'Does not apply opacity and blend mode to single child path with own blend mode',
      () async {
    final Node node = await parseAndResolve('''
<svg viewBox="0 0 200 200">
  <g opacity="0.5" style="mix-blend-mode:color-burn">
    <rect x="0" y="0" width="10" height="10" fill="white" style="mix-blend-mode:darken"/>
  </g>
</svg>''');

    final OpacityPeepholeOptimizer visitor = OpacityPeepholeOptimizer();
    final Node newNode = visitor.apply(node);
    final ResolvedPathNode pathNode =
        queryChildren<ResolvedPathNode>(newNode).single;

    expect(pathNode.paint.fill?.color, const Color(0xffffffff));
    expect(pathNode.paint.blendMode, BlendMode.darken);
  });

  test('Does not apply opacity to overlapping child paths', () async {
    final Node node = await parseAndResolve('''
<svg viewBox="0 0 200 200">
  <g opacity="0.5">
    <rect x="0" y="0" width="10" height="10" fill="white" />
    <rect x="5" y="5" width="10" height="10" fill="white" />
  </g>
</svg>''');

    final OpacityPeepholeOptimizer visitor = OpacityPeepholeOptimizer();
    final Node newNode = visitor.apply(node);
    final List<ResolvedPathNode> pathNodes =
        queryChildren<ResolvedPathNode>(newNode);

    expect(pathNodes[0].paint.fill?.color, const Color(0xffffffff));
    expect(pathNodes[1].paint.fill?.color, const Color(0xffffffff));
  });

  test('Does not apply opacity to text nodes', () async {
    final Node node = await parseAndResolve('''
<svg viewBox="0 0 200 200">
  <g opacity="0.5">
    <text x="0" y="0" fill="white">Hello</text>
  </g>
</svg>''');

    final OpacityPeepholeOptimizer visitor = OpacityPeepholeOptimizer();
    final Node newNode = visitor.apply(node);
    final ResolvedTextNode textNode =
        queryChildren<ResolvedTextNode>(newNode).single;

    expect(textNode.paint.fill?.color, const Color(0xffffffff));
  });

  test('Collapses nested opacity groups multiplicatively', () async {
    final Node node = await parseAndResolve('''
<svg viewBox="0 0 200 200">
  <g opacity="0.5">
    <g opacity="0.3">
      <g opacity="0.2">
        <rect x="0" y="0" width="10" height="10" fill="white" />
      </g>
    </g>
  </g>
</svg>''');

    final OpacityPeepholeOptimizer visitor = OpacityPeepholeOptimizer();
    final Node newNode = visitor.apply(node);
    final ResolvedPathNode textNode =
        queryChildren<ResolvedPathNode>(newNode).single;

    expect(textNode.paint.fill?.color, const Color(0x07ffffff));
  });

  test('Forwards opacity through multiple save layers', () async {
    final Node node = await parseAndResolve('''
<svg width="167" height="193" viewBox="0 0 167 193" fill="none" xmlns="http://www.w3.org/2000/svg">
<g opacity="0.6">
<g clip-path="url(#clip0_104_2007)">
<path d="M109.938 189.644C108.743 189.644 107.57 189.33 106.534 188.735C105.499 188.139 104.637 187.283 104.035 186.251C103.434 185.219 103.113 184.048 103.105 182.853C103.097 181.659 103.401 180.483 103.989 179.443L139.097 117.232C139.539 116.449 140.13 115.762 140.837 115.208C141.544 114.655 142.353 114.246 143.218 114.005C144.083 113.764 144.987 113.696 145.879 113.804C146.77 113.912 147.632 114.195 148.414 114.637C149.196 115.078 149.884 115.669 150.437 116.376C150.991 117.083 151.4 117.892 151.641 118.758C151.882 119.623 151.95 120.527 151.842 121.418C151.733 122.31 151.45 123.171 151.009 123.953L115.896 186.167C115.301 187.224 114.435 188.105 113.388 188.717C112.34 189.33 111.148 189.652 109.934 189.652L109.938 189.644Z" fill="#FFFFFF"/>
<path d="M108.044 145.669C104.888 145.669 101.803 144.733 99.1782 142.979C96.5538 141.226 94.5083 138.733 93.3005 135.817C92.0926 132.901 91.7766 129.693 92.3923 126.597C93.0081 123.501 94.528 120.658 96.7599 118.426C98.9917 116.194 101.835 114.674 104.931 114.058C108.027 113.443 111.235 113.759 114.151 114.966C117.067 116.174 119.56 118.22 121.313 120.844C123.067 123.469 124.003 126.554 124.003 129.71C123.998 133.941 122.315 137.998 119.324 140.99C116.332 143.981 112.275 145.664 108.044 145.669ZM108.044 125.142C107.142 125.142 106.26 125.409 105.51 125.91C104.76 126.411 104.175 127.123 103.83 127.956C103.484 128.789 103.394 129.706 103.569 130.591C103.745 131.476 104.179 132.289 104.817 132.927C105.455 133.565 106.267 133.999 107.152 134.175C108.037 134.351 108.954 134.261 109.787 133.916C110.62 133.571 111.333 132.986 111.834 132.236C112.335 131.486 112.603 130.605 112.603 129.703C112.602 128.494 112.121 127.335 111.267 126.48C110.412 125.625 109.253 125.144 108.044 125.142Z" fill="#D4D4D8"/>
<path d="M146.944 189.644C143.787 189.644 140.702 188.708 138.077 186.954C135.452 185.2 133.407 182.707 132.199 179.791C130.992 176.874 130.676 173.665 131.293 170.569C131.91 167.473 133.43 164.629 135.663 162.398C137.896 160.167 140.74 158.647 143.837 158.033C146.933 157.418 150.142 157.735 153.058 158.945C155.974 160.154 158.466 162.201 160.218 164.827C161.97 167.452 162.905 170.539 162.903 173.696C162.898 177.926 161.215 181.983 158.223 184.974C155.231 187.966 151.175 189.649 146.944 189.654V189.644ZM146.944 169.127C146.043 169.127 145.161 169.395 144.411 169.895C143.662 170.396 143.077 171.108 142.732 171.941C142.386 172.774 142.295 173.69 142.471 174.575C142.646 175.459 143.08 176.272 143.717 176.91C144.354 177.548 145.166 177.983 146.05 178.16C146.934 178.336 147.851 178.247 148.684 177.903C149.517 177.559 150.23 176.976 150.732 176.227C151.234 175.478 151.503 174.597 151.505 173.696C151.503 172.487 151.022 171.328 150.167 170.473C149.312 169.619 148.153 169.138 146.944 169.137V169.127Z" fill="#D4D4D8"/>
<g opacity="0.5">
<path d="M67.1606 189.276C66.6918 189.856 66.0793 190.304 65.3839 190.574C64.6885 190.844 63.9345 190.927 63.1969 190.815C62.4594 190.703 61.7639 190.4 61.1799 189.936C60.5958 189.472 60.1434 188.863 59.8678 188.17L43.3747 146.714C43.1675 146.192 43.0649 145.635 43.0729 145.074C43.081 144.514 43.1994 143.96 43.4215 143.444C43.6436 142.929 43.9649 142.463 44.3672 142.072C44.7696 141.681 45.245 141.373 45.7663 141.166C46.2876 140.958 46.8446 140.856 47.4056 140.864C47.9665 140.872 48.5204 140.99 49.0356 141.212C49.5508 141.435 50.0172 141.756 50.4082 142.158C50.7991 142.561 51.1071 143.036 51.3143 143.557L67.8151 185.014C68.096 185.717 68.1843 186.482 68.071 187.231C67.9576 187.98 67.6467 188.685 67.1702 189.274L67.1606 189.276Z" fill="#FFFFFF"/>
<path d="M45.0342 172.959C43.7973 174.494 42.133 175.628 40.2517 176.217C38.3705 176.806 36.3568 176.824 34.4653 176.268C32.5738 175.713 30.8895 174.609 29.6253 173.097C28.3612 171.584 27.574 169.73 27.3633 167.77C27.1525 165.81 27.5278 163.832 28.4416 162.085C29.3553 160.338 30.7665 158.902 32.4967 157.957C34.227 157.012 36.1985 156.602 38.162 156.778C40.1254 156.953 41.9927 157.708 43.5276 158.945C45.5835 160.605 46.8968 163.013 47.1792 165.64C47.4617 168.268 46.6902 170.9 45.0342 172.959ZM35.0555 164.919C34.702 165.357 34.4866 165.891 34.4365 166.452C34.3864 167.014 34.5039 167.577 34.774 168.071C35.0441 168.566 35.4549 168.969 35.9542 169.23C36.4535 169.491 37.019 169.598 37.5792 169.538C38.1394 169.477 38.6691 169.252 39.1013 168.891C39.5335 168.529 39.8488 168.048 40.0073 167.507C40.1658 166.966 40.1604 166.391 39.9919 165.853C39.8233 165.316 39.499 164.84 39.0601 164.487C38.4718 164.013 37.7194 163.793 36.9684 163.874C36.2174 163.954 35.5293 164.33 35.0555 164.919Z" fill="#D4D4D8"/>
<path d="M81.6665 171.278C80.4295 172.813 78.7651 173.946 76.8839 174.535C75.0027 175.124 72.9891 175.142 71.0978 174.586C69.2065 174.031 67.5223 172.927 66.2583 171.414C64.9943 169.902 64.2072 168.048 63.9965 166.088C63.7859 164.128 64.1611 162.15 65.0748 160.403C65.9884 158.657 67.3995 157.22 69.1296 156.275C70.8596 155.331 72.831 154.92 74.7944 155.096C76.7578 155.271 78.625 156.025 80.16 157.262C82.2155 158.923 83.5285 161.331 83.811 163.958C84.0934 166.586 83.3222 169.218 81.6665 171.278ZM71.6878 163.242C71.3341 163.68 71.1185 164.214 71.0681 164.775C71.0177 165.336 71.1348 165.9 71.4047 166.394C71.6746 166.889 72.0851 167.292 72.5843 167.554C73.0836 167.815 73.649 167.922 74.2093 167.862C74.7695 167.802 75.2993 167.577 75.7317 167.216C76.164 166.855 76.4796 166.373 76.6383 165.833C76.7971 165.292 76.792 164.716 76.6236 164.179C76.4553 163.641 76.1312 163.165 75.6925 162.812C75.104 162.339 74.352 162.119 73.6013 162.199C72.8507 162.28 72.1626 162.655 71.6878 163.242Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M-5.26415 23.443C-5.91022 23.1692 -6.47329 22.7309 -6.89728 22.1718C-7.32127 21.6127 -7.59138 20.9523 -7.6807 20.2563C-7.77003 19.5603 -7.67545 18.8531 -7.40639 18.205C-7.13733 17.557 -6.70318 16.9907 -6.14718 16.5627L27.079 -9.05507C27.4968 -9.37714 27.974 -9.61377 28.4832 -9.75143C28.9925 -9.8891 29.5239 -9.92511 30.0471 -9.85741C30.5703 -9.7897 31.075 -9.61962 31.5325 -9.35686C31.9899 -9.09409 32.3911 -8.7438 32.7132 -8.32598C33.0353 -7.90816 33.2719 -7.431 33.4096 -6.92173C33.5472 -6.41247 33.5832 -5.88107 33.5155 -5.35789C33.4478 -4.8347 33.2777 -4.32998 33.015 -3.87253C32.7522 -3.41508 32.4019 -3.01386 31.9841 -2.69179L-1.24207 22.926C-1.80651 23.3609 -2.4764 23.6379 -3.18314 23.7288C-3.88988 23.8196 -4.60806 23.721 -5.26415 23.443Z" fill="#D4D4D8"/>
<path d="M3.77528 -0.776609C2.06756 -1.49888 0.61238 -2.71135 -0.406227 -4.26068C-1.42483 -5.81002 -1.96111 -7.62662 -1.94725 -9.48075C-1.93338 -11.3349 -1.36999 -13.1433 -0.328324 -14.6772C0.713342 -16.2111 2.18649 -17.4017 3.90483 -18.0983C5.62316 -18.795 7.50949 -18.9664 9.32526 -18.591C11.141 -18.2155 12.8047 -17.31 14.1058 -15.989C15.4069 -14.668 16.2871 -12.9908 16.635 -11.1696C16.9829 -9.34834 16.7829 -7.46482 16.0603 -5.75724C15.0895 -3.46956 13.2508 -1.66039 10.9477 -0.726665C8.64459 0.207062 6.06515 0.1891 3.77528 -0.776609ZM8.47125 -11.8765C7.98343 -12.0828 7.4454 -12.1398 6.92519 -12.0403C6.40499 -11.9408 5.92597 -11.6893 5.54869 -11.3175C5.17141 -10.9458 4.91282 -10.4706 4.80561 -9.95191C4.6984 -9.43324 4.74738 -8.89443 4.94637 -8.40359C5.14535 -7.91276 5.48541 -7.49195 5.92353 -7.19436C6.36166 -6.89677 6.87819 -6.73577 7.40781 -6.73171C7.93743 -6.72765 8.45636 -6.88072 8.89899 -7.17156C9.34162 -7.46241 9.68808 -7.87796 9.89457 -8.36569C10.171 -9.02003 10.1764 -9.75737 9.90953 -10.4157C9.64265 -11.074 9.12533 -11.5994 8.47125 -11.8765Z" fill="#D4D4D8"/>
<path d="M14.7553 31.9132C13.0475 31.1909 11.5924 29.9784 10.5738 28.4291C9.55515 26.8798 9.01887 25.0632 9.03273 23.209C9.0466 21.3549 9.60999 19.5465 10.6517 18.0126C11.6933 16.4787 13.1665 15.2881 14.8848 14.5915C16.6031 13.8948 18.4895 13.7234 20.3052 14.0988C22.121 14.4743 23.7847 15.3798 25.0858 16.7008C26.3869 18.0218 27.2671 19.6989 27.615 21.5202C27.9629 23.3414 27.7629 25.225 27.0403 26.9325C26.0686 29.2195 24.2299 31.028 21.9271 31.9616C19.6243 32.8953 17.0452 32.8778 14.7553 31.9132ZM19.4512 20.8133C18.9634 20.607 18.4254 20.55 17.9052 20.6495C17.385 20.749 16.9059 21.0005 16.5287 21.3723C16.1514 21.744 15.8928 22.2192 15.7856 22.7379C15.6784 23.2565 15.7274 23.7954 15.9263 24.2862C16.1253 24.777 16.4654 25.1978 16.9035 25.4954C17.3416 25.793 17.8582 25.954 18.3878 25.9581C18.9174 25.9621 19.4363 25.8091 19.879 25.5182C20.3216 25.2274 20.6681 24.8118 20.8745 24.3241C21.1499 23.6696 21.1548 22.9327 20.888 22.2747C20.6213 21.6167 20.1046 21.0912 19.4512 20.8133Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M-29.892 95.664C-30.8525 95.348 -31.7135 94.7859 -32.3894 94.0338C-33.0652 93.2816 -33.5323 92.3656 -33.7441 91.3769C-33.956 90.3882 -33.9052 89.3612 -33.5968 88.3982C-33.2885 87.4352 -32.7333 86.5698 -31.9866 85.888L12.6733 45.1101C13.2326 44.5857 13.8905 44.1776 14.6089 43.9096C15.3272 43.6415 16.0916 43.5187 16.8577 43.5485C17.6238 43.5782 18.3764 43.7597 19.0718 44.0826C19.7672 44.4056 20.3916 44.8634 20.9086 45.4295C21.4257 45.9956 21.8251 46.6588 22.0838 47.3805C22.3425 48.1023 22.4553 48.8682 22.4156 49.6339C22.3759 50.3996 22.1846 51.1498 21.8527 51.8409C21.5207 52.532 21.0548 53.1503 20.482 53.66L-24.1783 94.4397C-24.9366 95.1321 -25.8654 95.6103 -26.8694 95.8255C-27.8734 96.0406 -28.9166 95.9849 -29.892 95.664Z" fill="#D4D4D8"/>
<path d="M-19.8121 59.791C-22.3513 58.9583 -24.5865 57.3913 -26.2351 55.2882C-27.8837 53.1851 -28.8717 50.6404 -29.074 47.9758C-29.2763 45.3112 -28.6839 42.6465 -27.3717 40.3186C-26.0596 37.9907 -24.0866 36.1042 -21.7022 34.8977C-19.3179 33.6911 -16.6293 33.2187 -13.9765 33.5402C-11.3236 33.8617 -8.82573 34.9626 -6.7986 36.7038C-4.77148 38.4449 -3.3062 40.7481 -2.58807 43.3221C-1.86994 45.896 -1.93121 48.6251 -2.76414 51.1642C-3.88404 54.5666 -6.308 57.3858 -9.5041 59.0032C-12.7002 60.6205 -16.4074 60.9038 -19.8121 59.791ZM-14.3973 43.286C-15.1224 43.0481 -15.9018 43.0305 -16.6369 43.2355C-17.372 43.4404 -18.0299 43.8588 -18.5273 44.4375C-19.0247 45.0163 -19.3394 45.7296 -19.4315 46.4871C-19.5237 47.2447 -19.3891 48.0126 -19.0449 48.6937C-18.7007 49.3749 -18.1623 49.9387 -17.4978 50.3139C-16.8332 50.689 -16.0723 50.8588 -15.3113 50.8016C-14.5503 50.7445 -13.8233 50.463 -13.2222 49.9928C-12.6212 49.5225 -12.173 48.8846 -11.9344 48.1597C-11.6179 47.1868 -11.6993 46.1281 -12.1608 45.2149C-12.6222 44.3018 -13.4263 43.6083 -14.3973 43.286Z" fill="#D4D4D8"/>
<path d="M-0.120984 105.43C-2.66016 104.597 -4.89538 103.03 -6.54398 100.927C-8.19257 98.8238 -9.18049 96.2791 -9.38281 93.6145C-9.58512 90.95 -8.99274 88.2852 -7.68058 85.9573C-6.36842 83.6294 -4.39542 81.7429 -2.01107 80.5364C0.37327 79.3298 3.06186 78.8574 5.71469 79.1789C8.36752 79.5004 10.8654 80.6013 12.8926 82.3425C14.9197 84.0836 16.385 86.3868 17.1031 88.9607C17.8212 91.5347 17.7599 94.2638 16.927 96.8029C15.8067 100.205 13.3827 103.024 10.1867 104.641C6.99074 106.258 3.28379 106.542 -0.120984 105.43ZM5.292 88.9242C4.56682 88.6867 3.78751 88.6695 3.05256 88.8747C2.31761 89.08 1.66001 89.4985 1.16286 90.0774C0.665712 90.6564 0.351332 91.3697 0.259453 92.1272C0.167575 92.8847 0.302322 93.6525 0.646663 94.3334C0.991006 95.0144 1.52948 95.578 2.19405 95.953C2.85862 96.3281 3.61944 96.4977 4.38037 96.4404C5.1413 96.3831 5.86818 96.1016 6.46914 95.6314C7.0701 95.1611 7.51818 94.5233 7.75674 93.7984C8.0733 92.8252 7.99176 91.7662 7.52992 90.8528C7.06808 89.9395 6.2635 89.2461 5.292 88.9242Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M46.6609 104.643C46.1115 104.612 45.5795 104.439 45.118 104.139C44.6565 103.839 44.2816 103.424 44.0305 102.934C43.7794 102.445 43.6609 101.898 43.6869 101.348C43.7128 100.799 43.8823 100.265 44.1783 99.8014L61.8759 72.0632C62.3308 71.3712 63.0399 70.8861 63.8497 70.7129C64.6596 70.5397 65.5051 70.6923 66.2032 71.1377C66.9014 71.5832 67.3961 72.2856 67.5804 73.093C67.7646 73.9004 67.6235 74.7479 67.1876 75.4521L49.4901 103.19C49.1893 103.661 48.7689 104.044 48.2718 104.299C47.7747 104.554 47.2188 104.673 46.6609 104.643Z" fill="#D4D4D8"/>
<path d="M46.8854 84.3696C45.4319 84.2907 44.0344 83.7826 42.8697 82.9093C41.705 82.0361 40.8254 80.837 40.3423 79.4638C39.8592 78.0906 39.7943 76.605 40.1557 75.1948C40.5171 73.7847 41.2886 72.5135 42.3726 71.5419C43.4567 70.5703 44.8045 69.9421 46.2456 69.7367C47.6868 69.5313 49.1565 69.758 50.4688 70.388C51.7811 71.018 52.877 72.0231 53.618 73.2761C54.3589 74.5292 54.7116 75.9738 54.6314 77.4273C54.5239 79.3747 53.6477 81.1998 52.1952 82.5016C50.7428 83.8033 48.833 84.4752 46.8854 84.3696ZM47.3986 74.9331C46.9841 74.9107 46.5722 75.0118 46.2151 75.2235C45.8579 75.4352 45.5716 75.748 45.3923 76.1225C45.2129 76.4969 45.1487 76.9161 45.2076 77.3271C45.2665 77.738 45.4459 78.1223 45.7232 78.4312C46.0005 78.7402 46.3632 78.96 46.7654 79.0629C47.1677 79.1657 47.5913 79.147 47.9829 79.0091C48.3745 78.8712 48.7164 78.6202 48.9653 78.288C49.2143 77.9558 49.3591 77.5572 49.3816 77.1426C49.3965 76.8673 49.357 76.5918 49.2654 76.3318C49.1738 76.0717 49.0319 75.8323 48.8477 75.6271C48.6636 75.4219 48.4409 75.2551 48.1922 75.136C47.9436 75.0169 47.6739 74.9479 47.3986 74.9331Z" fill="#D4D4D8"/>
<path d="M63.6826 105.564C62.229 105.486 60.8315 104.977 59.6668 104.104C58.5021 103.231 57.6226 102.032 57.1395 100.659C56.6564 99.2854 56.5914 97.7998 56.9528 96.3897C57.3142 94.9795 58.0857 93.7083 59.1697 92.7367C60.2538 91.7652 61.6016 91.1369 63.0428 90.9315C64.4839 90.7261 65.9536 90.9528 67.2659 91.5828C68.5782 92.2128 69.6741 93.218 70.4151 94.471C71.1561 95.724 71.5087 97.1686 71.4285 98.6221C71.321 100.57 70.4448 102.395 68.9924 103.696C67.5399 104.998 65.6301 105.67 63.6826 105.564ZM64.1938 96.1279C63.7787 96.1051 63.3662 96.206 63.0085 96.4177C62.6507 96.6295 62.3638 96.9426 62.1841 97.3174C62.0044 97.6922 61.9399 98.112 61.9987 98.5235C62.0576 98.935 62.2373 99.3198 62.5149 99.6292C62.7926 99.9386 63.1558 100.159 63.5586 100.262C63.9613 100.364 64.3856 100.346 64.7776 100.207C65.1696 100.069 65.5118 99.8175 65.7609 99.4846C66.01 99.1518 66.1547 98.7526 66.1768 98.3374C66.2058 97.7817 66.0134 97.2372 65.6417 96.823C65.2701 96.4089 64.7494 96.1589 64.1938 96.1279Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M141.008 101.552C140.188 101.281 139.454 100.799 138.877 100.156C138.301 99.512 137.904 98.7288 137.724 97.8839C137.545 97.039 137.59 96.1618 137.855 95.3397C138.12 94.5175 138.595 93.7791 139.234 93.1979L177.441 58.4284C177.922 57.9912 178.483 57.653 179.094 57.4329C179.706 57.2129 180.354 57.1154 181.003 57.146C181.652 57.1765 182.288 57.3346 182.876 57.6111C183.463 57.8876 183.991 58.2772 184.428 58.7576C184.865 59.238 185.203 59.7997 185.423 60.4108C185.644 61.0219 185.741 61.6704 185.71 62.3192C185.68 62.968 185.522 63.6044 185.245 64.1921C184.969 64.7798 184.579 65.3073 184.099 65.7444L145.89 100.514C145.242 101.105 144.448 101.512 143.59 101.695C142.732 101.877 141.841 101.828 141.008 101.552Z" fill="#D4D4D8"/>
<path d="M149.674 70.9226C147.507 70.2075 145.6 68.8658 144.195 67.0671C142.79 65.2684 141.95 63.0935 141.782 60.8175C141.613 58.5415 142.123 56.2665 143.247 54.2802C144.371 52.294 146.059 50.6857 148.097 49.6588C150.135 48.6318 152.432 48.2323 154.698 48.5108C156.963 48.7893 159.095 49.7332 160.823 51.2233C162.552 52.7133 163.8 54.6825 164.41 56.8819C165.019 59.0813 164.963 61.412 164.248 63.5794C163.286 66.4833 161.211 68.8871 158.479 70.2637C155.747 71.6402 152.581 71.8772 149.674 70.9226ZM154.322 56.8327C153.703 56.63 153.039 56.615 152.412 56.7896C151.785 56.9643 151.224 57.3208 150.8 57.8141C150.376 58.3074 150.107 58.9154 150.028 59.5612C149.949 60.2071 150.063 60.8619 150.356 61.4429C150.649 62.0239 151.108 62.5051 151.674 62.8256C152.24 63.1462 152.889 63.2918 153.538 63.244C154.187 63.1961 154.807 62.9571 155.32 62.557C155.833 62.157 156.216 61.6138 156.421 60.9962C156.557 60.585 156.611 60.151 156.579 59.719C156.547 59.287 156.43 58.8655 156.235 58.4788C156.04 58.092 155.771 57.7475 155.443 57.465C155.114 57.1826 154.733 56.9677 154.322 56.8327Z" fill="#D4D4D8"/>
<path d="M166.425 109.939C164.257 109.224 162.35 107.882 160.945 106.083C159.539 104.284 158.699 102.109 158.53 99.8325C158.361 97.5561 158.871 95.2807 159.995 93.294C161.12 91.3074 162.808 89.6987 164.846 88.6715C166.885 87.6443 169.182 87.2446 171.448 87.523C173.713 87.8014 175.846 88.7454 177.575 90.2356C179.304 91.7259 180.552 93.6954 181.162 95.8951C181.772 98.0948 181.716 100.426 181.001 102.594C180.038 105.498 177.963 107.902 175.231 109.279C172.498 110.656 169.332 110.893 166.425 109.939ZM171.072 95.847C170.454 95.6444 169.79 95.6295 169.163 95.8042C168.536 95.9789 167.975 96.3354 167.551 96.8286C167.127 97.3219 166.858 97.9297 166.779 98.5755C166.7 99.2212 166.814 99.8759 167.107 100.457C167.4 101.038 167.858 101.519 168.424 101.84C168.99 102.16 169.639 102.306 170.288 102.259C170.936 102.211 171.557 101.972 172.07 101.573C172.583 101.173 172.966 100.63 173.171 100.012C173.308 99.6011 173.362 99.1669 173.33 98.7347C173.298 98.3025 173.182 97.8808 172.987 97.4938C172.792 97.1068 172.522 96.7622 172.194 96.4796C171.865 96.197 171.484 95.982 171.072 95.847Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M43.955 21.8598C42.9757 21.8059 42.0276 21.4964 41.205 20.9622C40.3825 20.428 39.7142 19.6877 39.2666 18.815C38.8191 17.9422 38.608 16.9675 38.6542 15.9878C38.7004 15.0081 39.0024 14.0576 39.5302 13.2309L71.0813 -36.2192C71.4743 -36.8487 71.9883 -37.3941 72.5934 -37.8238C73.1985 -38.2535 73.8827 -38.559 74.6066 -38.7226C75.3305 -38.8862 76.0796 -38.9048 76.8107 -38.7771C77.5418 -38.6495 78.2403 -38.3782 78.8659 -37.979C79.4915 -37.5797 80.0318 -37.0604 80.4555 -36.4511C80.8792 -35.8418 81.1779 -35.1546 81.3344 -34.4291C81.4909 -33.7037 81.502 -32.9544 81.3672 -32.2246C81.2323 -31.4948 80.9542 -30.799 80.5488 -30.1774L48.9996 19.2707C48.4648 20.1096 47.7169 20.7913 46.8323 21.2462C45.9476 21.7011 44.958 21.9129 43.9647 21.8598H43.955Z" fill="#D4D4D8"/>
<path d="M74.3016 23.5039C71.7136 23.3638 69.2253 22.4593 67.1513 20.905C65.0774 19.3506 63.5109 17.2162 62.65 14.7716C61.7891 12.327 61.6725 9.68194 62.3149 7.17103C62.9572 4.66012 64.3298 2.39608 66.2589 0.665226C68.188 -1.06563 70.587 -2.18557 73.1526 -2.55297C75.7182 -2.92036 78.3352 -2.51871 80.6725 -1.3988C83.0098 -0.278898 84.9626 1.50896 86.2838 3.73868C87.605 5.96841 88.2354 8.53986 88.0952 11.1278C87.9031 14.5967 86.3431 17.8477 83.7572 20.1678C81.1714 22.4879 77.7709 23.6877 74.3016 23.5039ZM75.2118 6.67974C74.4726 6.63987 73.7383 6.82003 73.1015 7.19745C72.4648 7.57487 71.9542 8.1326 71.6344 8.80014C71.3146 9.46768 71.1998 10.2151 71.3047 10.9478C71.4095 11.6805 71.7293 12.3657 72.2235 12.9168C72.7177 13.4678 73.3642 13.86 74.0812 14.0436C74.7983 14.2273 75.5537 14.1943 76.252 13.9488C76.9503 13.7032 77.5601 13.2561 78.0043 12.6641C78.4485 12.072 78.7073 11.3615 78.7478 10.6224C78.8001 9.6314 78.4575 8.66004 77.7951 7.92107C77.1327 7.1821 76.2045 6.73574 75.2137 6.67974H75.2118Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M-2.79557 144.937C-3.22533 144.912 -3.64104 144.775 -4.00145 144.539C-4.36186 144.304 -4.65445 143.978 -4.85017 143.595C-5.0459 143.212 -5.13798 142.784 -5.11726 142.354C-5.09654 141.924 -4.96374 141.507 -4.73206 141.144L9.14091 119.403C9.51376 118.903 10.0621 118.562 10.6756 118.45C11.2892 118.338 11.9225 118.462 12.4484 118.797C12.9742 119.133 13.3536 119.655 13.5102 120.259C13.6668 120.862 13.5891 121.503 13.2927 122.052L-0.578298 143.799C-0.813805 144.168 -1.14323 144.468 -1.53284 144.668C-1.92245 144.868 -2.35824 144.961 -2.79557 144.937Z" fill="#D4D4D8"/>
<path d="M-2.61737 129.046C-3.75501 128.985 -4.84892 128.588 -5.76079 127.905C-6.67266 127.222 -7.36154 126.284 -7.74035 125.209C-8.11916 124.135 -8.17087 122.972 -7.88896 121.868C-7.60705 120.764 -7.00417 119.769 -6.15654 119.008C-5.30892 118.246 -4.2546 117.753 -3.1269 117.591C-1.9992 117.429 -0.848744 117.605 0.179012 118.097C1.20677 118.588 2.06567 119.374 2.64714 120.353C3.22861 121.333 3.50653 122.463 3.44576 123.601C3.36174 125.126 2.67611 126.555 1.53936 127.575C0.40261 128.595 -1.09235 129.122 -2.61737 129.041V129.046ZM-2.21652 121.651C-2.5413 121.632 -2.86429 121.711 -3.1447 121.875C-3.42512 122.04 -3.65038 122.285 -3.79206 122.578C-3.93373 122.87 -3.98545 123.199 -3.94069 123.521C-3.89593 123.843 -3.7567 124.145 -3.54057 124.388C-3.32445 124.631 -3.04113 124.805 -2.72639 124.887C-2.41164 124.969 -2.07959 124.956 -1.77216 124.85C-1.46473 124.744 -1.19571 124.548 -0.999074 124.289C-0.802434 124.03 -0.686995 123.719 -0.667331 123.394C-0.654494 123.178 -0.684392 122.961 -0.75532 122.756C-0.826247 122.552 -0.936811 122.363 -1.08069 122.201C-1.22457 122.039 -1.39894 121.908 -1.59383 121.813C-1.78872 121.719 -2.00032 121.664 -2.21652 121.651Z" fill="#D4D4D8"/>
<path d="M10.5467 145.66C9.40893 145.598 8.3149 145.201 7.40299 144.517C6.49107 143.834 5.80223 142.896 5.42358 141.821C5.04493 140.747 4.99349 139.584 5.27574 138.48C5.55799 137.376 6.16127 136.38 7.00928 135.619C7.85729 134.858 8.91195 134.366 10.0399 134.204C11.1678 134.042 12.3183 134.219 13.346 134.711C14.3736 135.203 15.2322 135.989 15.8132 136.97C16.3942 137.95 16.6714 139.08 16.6099 140.218C16.5253 141.743 15.8396 143.172 14.703 144.192C13.5665 145.212 12.0718 145.74 10.5467 145.66ZM10.9476 138.264C10.6223 138.245 10.2988 138.324 10.018 138.489C9.73721 138.654 9.51181 138.899 9.37034 139.193C9.22887 139.486 9.17769 139.815 9.2233 140.138C9.2689 140.46 9.40923 140.762 9.6265 141.005C9.84378 141.248 10.1282 141.421 10.4438 141.502C10.7594 141.583 11.092 141.568 11.3993 141.46C11.7067 141.352 11.9751 141.155 12.1704 140.894C12.3658 140.634 12.4794 140.321 12.4968 139.995C12.52 139.561 12.3701 139.134 12.0797 138.81C11.7894 138.485 11.3823 138.289 10.9476 138.264Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M102.322 100.806C101.982 100.788 101.653 100.68 101.367 100.495C101.081 100.31 100.849 100.053 100.694 99.7494C100.538 99.4463 100.465 99.1077 100.481 98.7675C100.498 98.4272 100.603 98.0972 100.787 97.8103L111.739 80.6415C111.877 80.4253 112.056 80.2384 112.266 80.0915C112.476 79.9445 112.713 79.8404 112.964 79.785C113.214 79.7296 113.473 79.724 113.725 79.7687C113.978 79.8133 114.219 79.9072 114.435 80.045C114.651 80.1828 114.838 80.3619 114.985 80.572C115.132 80.782 115.236 81.019 115.292 81.2693C115.347 81.5196 115.352 81.7784 115.308 82.0308C115.263 82.2833 115.169 82.5245 115.032 82.7406L104.077 99.9075C103.892 100.198 103.633 100.434 103.327 100.592C103.021 100.75 102.678 100.824 102.334 100.806H102.322Z" fill="#D4D4D8"/>
<path d="M102.462 88.2596C101.563 88.2108 100.7 87.8968 99.98 87.3572C99.2602 86.8176 98.7166 86.0767 98.4178 85.2281C98.1191 84.3796 98.0786 83.4615 98.3016 82.59C98.5246 81.7185 99.001 80.9326 99.6705 80.3318C100.34 79.7311 101.173 79.3423 102.063 79.2147C102.954 79.0871 103.862 79.2264 104.673 79.615C105.485 80.0036 106.163 80.6241 106.621 81.3979C107.08 82.1718 107.299 83.0643 107.251 83.9626C107.183 85.1666 106.641 86.2948 105.744 87.1002C104.846 87.9056 103.666 88.3225 102.462 88.2596ZM102.783 82.4172C102.527 82.4035 102.272 82.466 102.051 82.5971C101.83 82.7281 101.653 82.9217 101.542 83.1534C101.431 83.3851 101.391 83.6445 101.427 83.8988C101.464 84.1532 101.575 84.391 101.746 84.5822C101.918 84.7735 102.142 84.9096 102.391 84.9734C102.64 85.0372 102.902 85.0258 103.144 84.9406C103.387 84.8554 103.598 84.7003 103.753 84.4949C103.907 84.2894 103.997 84.0428 104.011 83.7863C104.029 83.4422 103.91 83.1049 103.68 82.8483C103.45 82.5917 103.127 82.4367 102.783 82.4172Z" fill="#D4D4D8"/>
<path d="M112.853 101.377C111.955 101.327 111.091 101.012 110.372 100.471C109.653 99.9305 109.11 99.1887 108.813 98.3395C108.515 97.4904 108.476 96.5721 108.701 95.7009C108.925 94.8296 109.403 94.0444 110.074 93.4447C110.745 92.845 111.578 92.4576 112.469 92.3316C113.36 92.2056 114.268 92.3466 115.079 92.7368C115.889 93.127 116.566 93.7489 117.023 94.5237C117.481 95.2986 117.698 96.1916 117.648 97.09C117.579 98.2937 117.035 99.421 116.136 100.225C115.238 101.028 114.057 101.443 112.853 101.377ZM113.174 95.5408C112.918 95.527 112.663 95.5896 112.442 95.7206C112.221 95.8516 112.044 96.0452 111.933 96.2769C111.822 96.5086 111.782 96.768 111.818 97.0224C111.855 97.2767 111.966 97.5145 112.137 97.7058C112.309 97.8971 112.533 98.0332 112.782 98.097C113.031 98.1608 113.293 98.1493 113.535 98.0642C113.778 97.979 113.99 97.8239 114.144 97.6184C114.298 97.413 114.388 97.1664 114.402 96.9099C114.421 96.5656 114.302 96.228 114.071 95.9713C113.841 95.7146 113.519 95.5598 113.174 95.5408Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M131.163 43.6374C130.823 43.619 130.493 43.5118 130.207 43.3264C129.922 43.141 129.689 42.8839 129.534 42.5807C129.379 42.2776 129.305 41.939 129.322 41.5988C129.338 41.2585 129.443 40.9285 129.627 40.6416L140.58 23.4728C140.718 23.2566 140.897 23.0697 141.107 22.9228C141.317 22.7758 141.554 22.6716 141.804 22.6163C142.054 22.5609 142.313 22.5553 142.566 22.6C142.818 22.6446 143.059 22.7385 143.275 22.8763C143.492 23.0141 143.678 23.1932 143.825 23.4033C143.972 23.6133 144.077 23.8503 144.132 24.1006C144.187 24.3509 144.193 24.6097 144.148 24.8621C144.104 25.1146 144.01 25.3558 143.872 25.5719L132.917 42.7388C132.732 43.0294 132.473 43.2658 132.167 43.4236C131.861 43.5815 131.518 43.6552 131.174 43.6374H131.163Z" fill="#D4D4D8"/>
<path d="M131.302 31.0909C130.404 31.0421 129.54 30.7281 128.82 30.1885C128.101 29.6489 127.557 28.908 127.258 28.0594C126.959 27.2109 126.919 26.2928 127.142 25.4213C127.365 24.5498 127.841 23.7639 128.511 23.1631C129.18 22.5623 130.013 22.1736 130.904 22.046C131.794 21.9184 132.702 22.0577 133.514 22.4463C134.325 22.8349 135.003 23.4554 135.462 24.2292C135.92 25.0031 136.139 25.8956 136.091 26.7938C136.023 27.9979 135.482 29.1261 134.584 29.9315C133.686 30.7369 132.506 31.1538 131.302 31.0909ZM131.624 25.2485C131.367 25.2348 131.112 25.2973 130.891 25.4284C130.67 25.5594 130.493 25.753 130.382 25.9847C130.271 26.2164 130.231 26.4758 130.268 26.7301C130.304 26.9845 130.415 27.2223 130.586 27.4135C130.758 27.6048 130.982 27.7409 131.231 27.8047C131.48 27.8685 131.742 27.8571 131.985 27.7719C132.227 27.6867 132.439 27.5316 132.593 27.3262C132.747 27.1207 132.837 26.8741 132.851 26.6176C132.869 26.2735 132.75 25.9362 132.52 25.6796C132.29 25.423 131.968 25.268 131.624 25.2485Z" fill="#D4D4D8"/>
<path d="M141.693 44.2086C140.795 44.1586 139.932 43.8432 139.212 43.3025C138.493 42.7618 137.951 42.0199 137.653 41.1708C137.356 40.3217 137.317 39.4034 137.541 38.5322C137.766 37.6609 138.243 36.8757 138.914 36.276C139.585 35.6763 140.418 35.2889 141.309 35.1629C142.2 35.0369 143.108 35.1779 143.919 35.5681C144.73 35.9583 145.407 36.5802 145.864 37.355C146.321 38.1299 146.538 39.0229 146.488 39.9213C146.419 41.125 145.876 42.2523 144.977 43.056C144.078 43.8597 142.897 44.2742 141.693 44.2086ZM142.015 38.3721C141.758 38.3583 141.503 38.4209 141.282 38.5519C141.061 38.6829 140.884 38.8765 140.773 39.1082C140.662 39.3399 140.622 39.5993 140.659 39.8537C140.695 40.108 140.806 40.3458 140.978 40.5371C141.149 40.7284 141.373 40.8645 141.622 40.9283C141.871 40.9921 142.133 40.9806 142.376 40.8955C142.618 40.8103 142.83 40.6552 142.984 40.4497C143.138 40.2443 143.228 39.9977 143.242 39.7412C143.261 39.3969 143.142 39.0593 142.912 38.8026C142.682 38.5459 142.359 38.3911 142.015 38.3721Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M1.51046 180.394C1.25271 180.395 0.999099 180.329 0.774944 180.201C0.550789 180.074 0.363931 179.89 0.233021 179.668C0.102111 179.446 0.0317277 179.194 0.0288975 178.936C0.0260672 178.678 0.0908889 178.424 0.216892 178.199L7.72464 164.741C7.91816 164.405 8.2362 164.159 8.60996 164.055C8.98371 163.952 9.38315 164 9.72186 164.188C10.0606 164.377 10.3113 164.692 10.4199 165.064C10.5285 165.436 10.4862 165.836 10.3021 166.178L2.79435 179.638C2.66641 179.867 2.48012 180.057 2.25454 180.19C2.02896 180.322 1.77218 180.393 1.51046 180.394Z" fill="#D4D4D8"/>
<path d="M1.05738 170.909C0.376415 170.912 -0.290274 170.713 -0.858384 170.338C-1.42649 169.963 -1.87051 169.427 -2.13429 168.799C-2.39806 168.171 -2.46974 167.479 -2.34027 166.811C-2.2108 166.142 -1.88599 165.527 -1.40692 165.043C-0.927841 164.559 -0.316016 164.228 0.351188 164.092C1.01839 163.956 1.71101 164.021 2.34146 164.278C2.97191 164.535 3.51187 164.974 3.89306 165.538C4.27426 166.102 4.47956 166.767 4.48302 167.448C4.48662 168.361 4.12798 169.238 3.48576 169.887C2.84355 170.535 1.97022 170.903 1.05738 170.909ZM1.03608 166.482C0.841514 166.483 0.651549 166.541 0.490203 166.65C0.328857 166.758 0.203376 166.913 0.129628 167.093C0.055881 167.273 0.0371799 167.471 0.0758886 167.661C0.114598 167.852 0.208978 168.027 0.347096 168.164C0.485213 168.301 0.660866 168.394 0.851838 168.431C1.04281 168.468 1.24053 168.448 1.41999 168.373C1.59945 168.298 1.75259 168.171 1.86004 168.009C1.9675 167.847 2.02445 167.656 2.02368 167.462C2.02215 167.201 1.91736 166.951 1.73225 166.768C1.54715 166.584 1.29682 166.481 1.03608 166.482Z" fill="#D4D4D8"/>
<path d="M9.4966 180.355C8.81555 180.358 8.14878 180.16 7.58063 179.784C7.01247 179.409 6.56846 178.873 6.30474 178.245C6.04102 177.617 5.96945 176.925 6.09907 176.256C6.2287 175.588 6.5537 174.973 7.03297 174.489C7.51224 174.005 8.12425 173.674 8.79158 173.538C9.45891 173.402 10.1516 173.467 10.782 173.725C11.4124 173.982 11.9523 174.421 12.3332 174.986C12.7142 175.55 12.9192 176.215 12.9222 176.896C12.9248 177.809 12.5658 178.685 11.9237 179.333C11.2817 179.981 10.4089 180.349 9.4966 180.355ZM9.47529 175.928C9.28073 175.929 9.09077 175.987 8.92942 176.096C8.76808 176.205 8.64259 176.359 8.56885 176.539C8.4951 176.719 8.4764 176.917 8.51511 177.107C8.55382 177.298 8.6482 177.473 8.78631 177.61C8.92443 177.747 9.10008 177.84 9.29106 177.877C9.48203 177.915 9.67975 177.894 9.8592 177.819C10.0387 177.744 10.1918 177.617 10.2993 177.455C10.4067 177.293 10.4637 177.102 10.4629 176.908C10.4609 176.647 10.3559 176.398 10.1709 176.215C9.98592 176.031 9.73589 175.928 9.47529 175.928Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M24.9135 121.392C24.6558 121.393 24.4022 121.327 24.178 121.2C23.9539 121.072 23.767 120.889 23.6361 120.667C23.5052 120.445 23.4348 120.192 23.432 119.934C23.4291 119.677 23.494 119.423 23.62 119.198L31.1277 105.739C31.3212 105.403 31.6393 105.157 32.013 105.053C32.3868 104.95 32.7862 104.998 33.1249 105.187C33.4637 105.376 33.7144 105.69 33.823 106.062C33.9316 106.435 33.8893 106.835 33.7052 107.176L26.1974 120.637C26.0695 120.865 25.8832 121.055 25.6576 121.188C25.432 121.321 25.1753 121.391 24.9135 121.392Z" fill="#D4D4D8"/>
<path d="M24.4605 111.907C23.7795 111.91 23.1128 111.712 22.5447 111.336C21.9766 110.961 21.5326 110.425 21.2688 109.798C21.005 109.17 20.9333 108.478 21.0628 107.809C21.1923 107.141 21.5171 106.526 21.9962 106.042C22.4752 105.558 23.0871 105.227 23.7543 105.09C24.4215 104.954 25.1141 105.019 25.7445 105.276C26.375 105.534 26.9149 105.972 27.2961 106.537C27.6773 107.101 27.8826 107.765 27.8861 108.446C27.8897 109.359 27.5311 110.236 26.8888 110.885C26.2466 111.534 25.3733 111.901 24.4605 111.907ZM24.4392 107.48C24.2446 107.481 24.0546 107.539 23.8933 107.648C23.7319 107.757 23.6065 107.911 23.5327 108.091C23.459 108.271 23.4403 108.469 23.479 108.66C23.5177 108.85 23.6121 109.025 23.7502 109.162C23.8883 109.299 24.0639 109.392 24.2549 109.429C24.4459 109.467 24.6436 109.446 24.8231 109.371C25.0025 109.296 25.1557 109.169 25.2631 109.007C25.3706 108.845 25.4275 108.655 25.4268 108.46C25.4252 108.199 25.3204 107.95 25.1353 107.766C24.9502 107.582 24.6999 107.48 24.4392 107.48Z" fill="#D4D4D8"/>
<path d="M32.8997 121.353C32.2186 121.357 31.5519 121.158 30.9837 120.782C30.4156 120.407 29.9715 119.871 29.7078 119.243C29.4441 118.615 29.3725 117.923 29.5022 117.255C29.6318 116.586 29.9568 115.971 30.436 115.487C30.9153 115.003 31.5273 114.672 32.1947 114.536C32.862 114.4 33.5547 114.465 34.1851 114.723C34.8155 114.981 35.3553 115.42 35.7363 115.984C36.1173 116.549 36.3222 117.213 36.3253 117.895C36.3279 118.807 35.9689 119.683 35.3268 120.331C34.6848 120.98 33.812 121.347 32.8997 121.353ZM32.8784 116.926C32.6838 116.927 32.4938 116.985 32.3325 117.094C32.1712 117.203 32.0457 117.357 31.9719 117.537C31.8982 117.717 31.8795 117.915 31.9182 118.106C31.9569 118.296 32.0513 118.471 32.1894 118.608C32.3275 118.745 32.5032 118.838 32.6941 118.876C32.8851 118.913 33.0828 118.893 33.2623 118.817C33.4417 118.742 33.5949 118.616 33.7023 118.453C33.8098 118.291 33.8667 118.101 33.866 117.906C33.8639 117.646 33.759 117.396 33.574 117.213C33.389 117.029 33.139 116.926 32.8784 116.926Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M64.9135 135.392C64.6558 135.393 64.4022 135.327 64.178 135.2C63.9539 135.072 63.767 134.889 63.6361 134.667C63.5052 134.445 63.4348 134.192 63.432 133.934C63.4291 133.677 63.494 133.423 63.62 133.198L71.1277 119.739C71.3212 119.403 71.6393 119.157 72.013 119.053C72.3868 118.95 72.7862 118.998 73.1249 119.187C73.4637 119.376 73.7144 119.69 73.823 120.062C73.9316 120.435 73.8893 120.835 73.7052 121.176L66.1974 134.637C66.0695 134.865 65.8832 135.055 65.6576 135.188C65.432 135.321 65.1753 135.391 64.9135 135.392Z" fill="#D4D4D8"/>
<path d="M64.4605 125.907C63.7795 125.91 63.1128 125.712 62.5447 125.336C61.9766 124.961 61.5326 124.425 61.2688 123.798C61.005 123.17 60.9333 122.478 61.0628 121.809C61.1923 121.141 61.5171 120.526 61.9962 120.042C62.4752 119.558 63.0871 119.227 63.7543 119.09C64.4215 118.954 65.1141 119.019 65.7445 119.276C66.375 119.534 66.9149 119.972 67.2961 120.537C67.6773 121.101 67.8826 121.765 67.8861 122.446C67.8897 123.359 67.5311 124.236 66.8888 124.885C66.2466 125.534 65.3733 125.901 64.4605 125.907ZM64.4392 121.48C64.2446 121.481 64.0546 121.539 63.8933 121.648C63.7319 121.757 63.6065 121.911 63.5327 122.091C63.459 122.271 63.4403 122.469 63.479 122.66C63.5177 122.85 63.6121 123.025 63.7502 123.162C63.8883 123.299 64.0639 123.392 64.2549 123.429C64.4459 123.467 64.6436 123.446 64.8231 123.371C65.0025 123.296 65.1557 123.169 65.2631 123.007C65.3706 122.845 65.4275 122.655 65.4268 122.46C65.4252 122.199 65.3204 121.95 65.1353 121.766C64.9502 121.582 64.6999 121.48 64.4392 121.48Z" fill="#D4D4D8"/>
<path d="M72.8997 135.353C72.2186 135.357 71.5519 135.158 70.9837 134.782C70.4156 134.407 69.9715 133.871 69.7078 133.243C69.4441 132.615 69.3725 131.923 69.5022 131.255C69.6318 130.586 69.9568 129.971 70.436 129.487C70.9153 129.003 71.5273 128.672 72.1947 128.536C72.862 128.4 73.5547 128.465 74.1851 128.723C74.8155 128.981 75.3553 129.42 75.7363 129.984C76.1173 130.549 76.3222 131.213 76.3253 131.895C76.3279 132.807 75.9689 133.683 75.3268 134.331C74.6848 134.98 73.812 135.347 72.8997 135.353ZM72.8784 130.926C72.6838 130.927 72.4938 130.985 72.3325 131.094C72.1712 131.203 72.0457 131.357 71.9719 131.537C71.8982 131.717 71.8795 131.915 71.9182 132.106C71.9569 132.296 72.0513 132.471 72.1894 132.608C72.3275 132.745 72.5032 132.838 72.6941 132.876C72.8851 132.913 73.0828 132.893 73.2623 132.817C73.4417 132.742 73.5949 132.616 73.7023 132.453C73.8098 132.291 73.8667 132.101 73.866 131.906C73.8639 131.646 73.759 131.396 73.574 131.213C73.389 131.029 73.139 130.926 72.8784 130.926Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M41.9135 55.3918C41.6558 55.3932 41.4022 55.327 41.178 55.1997C40.9539 55.0725 40.767 54.8887 40.6361 54.6666C40.5052 54.4446 40.4348 54.1921 40.432 53.9343C40.4291 53.6766 40.494 53.4226 40.62 53.1978L48.1277 39.7392C48.3212 39.4031 48.6393 39.1568 49.013 39.0534C49.3868 38.95 49.7862 38.9979 50.1249 39.1867C50.4637 39.3756 50.7144 39.6902 50.823 40.0624C50.9316 40.4347 50.8893 40.8348 50.7052 41.1761L43.1974 54.6366C43.0695 54.8649 42.8832 55.0551 42.6576 55.1878C42.432 55.3205 42.1753 55.3909 41.9135 55.3918Z" fill="#D4D4D8"/>
<path d="M41.4605 45.9069C40.7795 45.9103 40.1128 45.7118 39.5447 45.3363C38.9766 44.9608 38.5326 44.4253 38.2688 43.7975C38.005 43.1697 37.9333 42.4778 38.0628 41.8092C38.1923 41.1407 38.5171 40.5256 38.9962 40.0416C39.4752 39.5577 40.0871 39.2266 40.7543 39.0904C41.4215 38.9542 42.1141 39.0188 42.7445 39.2762C43.375 39.5336 43.9149 39.9722 44.2961 40.5365C44.6773 41.1008 44.8826 41.7654 44.8861 42.4464C44.8897 43.3592 44.5311 44.2362 43.8888 44.885C43.2466 45.5337 42.3733 45.9013 41.4605 45.9069ZM41.4392 41.4801C41.2446 41.4808 41.0546 41.5393 40.8933 41.648C40.7319 41.7568 40.6065 41.9109 40.5327 42.0909C40.459 42.271 40.4403 42.4689 40.479 42.6595C40.5177 42.8502 40.6121 43.0251 40.7502 43.1622C40.8883 43.2992 41.0639 43.3922 41.2549 43.4294C41.4459 43.4666 41.6436 43.4463 41.8231 43.3712C42.0025 43.296 42.1557 43.1693 42.2631 43.0071C42.3706 42.8449 42.4275 42.6545 42.4268 42.4599C42.4252 42.1992 42.3204 41.9497 42.1353 41.766C41.9502 41.5824 41.6999 41.4796 41.4392 41.4801Z" fill="#D4D4D8"/>
<path d="M49.8997 55.3531C49.2186 55.3565 48.5519 55.1579 47.9837 54.7824C47.4156 54.4068 46.9715 53.8712 46.7078 53.2433C46.4441 52.6154 46.3725 51.9233 46.5022 51.2547C46.6318 50.5861 46.9568 49.971 47.436 49.4871C47.9153 49.0032 48.5273 48.6724 49.1947 48.5363C49.862 48.4003 50.5547 48.4653 51.1851 48.723C51.8155 48.9807 52.3553 49.4196 52.7363 49.9841C53.1173 50.5486 53.3222 51.2135 53.3253 51.8945C53.3279 52.8069 52.9689 53.6831 52.3268 54.3313C51.6848 54.9795 50.812 55.3469 49.8997 55.3531ZM49.8784 50.9263C49.6838 50.927 49.4938 50.9855 49.3325 51.0942C49.1712 51.203 49.0457 51.3571 48.9719 51.5371C48.8982 51.7172 48.8795 51.915 48.9182 52.1057C48.9569 52.2964 49.0513 52.4713 49.1894 52.6083C49.3275 52.7454 49.5032 52.8384 49.6941 52.8756C49.8851 52.9128 50.0828 52.8925 50.2623 52.8174C50.4417 52.7422 50.5949 52.6155 50.7023 52.4533C50.8098 52.2911 50.8667 52.1007 50.866 51.9061C50.8639 51.6456 50.759 51.3963 50.574 51.2128C50.389 51.0293 50.139 50.9263 49.8784 50.9263Z" fill="#D4D4D8"/>
</g>
<g opacity="0.5">
<path d="M97.4686 71.1988C96.9439 71.4094 96.3732 71.4789 95.8133 71.4004C95.2534 71.3218 94.7239 71.0979 94.2774 70.751C93.831 70.4041 93.4832 69.9462 93.2688 69.4231C93.0544 68.8999 92.9808 68.3297 93.0553 67.7693L97.4899 34.2487C97.5457 33.8274 97.684 33.4211 97.8968 33.0532C98.1096 32.6852 98.3929 32.3628 98.7303 32.1043C99.0677 31.8458 99.4528 31.6563 99.8634 31.5466C100.274 31.4369 100.702 31.4092 101.124 31.465C101.545 31.5209 101.951 31.6591 102.319 31.872C102.687 32.0848 103.01 32.368 103.268 32.7054C103.527 33.0429 103.716 33.4279 103.826 33.8386C103.935 34.2492 103.963 34.6775 103.907 35.0989L99.4729 68.6194C99.3976 69.1885 99.1723 69.7273 98.8201 70.1805C98.4679 70.6338 98.0014 70.9852 97.4686 71.1988Z" fill="#D4D4D8"/>
<path d="M88.8823 52.2212C87.4964 52.778 85.9766 52.9114 84.515 52.6046C83.0533 52.2977 81.7155 51.5644 80.6706 50.4973C79.6257 49.4301 78.9206 48.0772 78.6446 46.6094C78.3685 45.1416 78.5338 43.625 79.1196 42.2512C79.7054 40.8773 80.6854 39.708 81.9357 38.8911C83.1859 38.0742 84.6504 37.6463 86.1438 37.6615C87.6372 37.6768 89.0926 38.1345 90.3259 38.9768C91.5593 39.819 92.5152 41.0081 93.0728 42.3936C93.8183 44.2527 93.7957 46.3316 93.0101 48.1741C92.2244 50.0166 90.7399 51.4721 88.8823 52.2212ZM85.2688 43.2088C84.8724 43.368 84.5322 43.641 84.2911 43.9935C84.05 44.346 83.9188 44.7621 83.9141 45.1891C83.9095 45.6162 84.0316 46.035 84.265 46.3927C84.4984 46.7503 84.8327 47.0307 85.2255 47.1984C85.6182 47.3661 86.0519 47.4135 86.4717 47.3347C86.8914 47.2559 87.2783 47.0543 87.5835 46.7556C87.8887 46.4569 88.0985 46.0743 88.1863 45.6564C88.2741 45.2384 88.2359 44.8038 88.0767 44.4075C87.8624 43.877 87.4466 43.4529 86.9203 43.2283C86.394 43.0036 85.8002 42.9966 85.2688 43.2088Z" fill="#D4D4D8"/>
<path d="M113.735 64.6651C112.349 65.222 110.829 65.3556 109.367 65.0487C107.906 64.7419 106.568 64.0086 105.523 62.9414C104.478 61.8742 103.773 60.5212 103.497 59.0533C103.221 57.5854 103.386 56.0686 103.972 54.6948C104.558 53.3209 105.538 52.1516 106.788 51.3347C108.039 50.5179 109.503 50.0902 110.997 50.1056C112.491 50.1211 113.946 50.5791 115.179 51.4217C116.412 52.2643 117.368 53.4536 117.926 54.8394C118.67 56.6982 118.648 58.7767 117.862 60.6187C117.076 62.4607 115.592 63.9159 113.735 64.6651ZM110.112 55.6546C109.716 55.814 109.377 56.0872 109.136 56.4395C108.896 56.7918 108.765 57.2075 108.761 57.6341C108.757 58.0607 108.879 58.4789 109.112 58.8359C109.346 59.193 109.68 59.4728 110.072 59.6401C110.465 59.8073 110.898 59.8545 111.317 59.7756C111.736 59.6967 112.123 59.4953 112.427 59.1968C112.732 58.8983 112.942 58.5162 113.029 58.0987C113.117 57.6813 113.079 57.2472 112.92 56.8514C112.814 56.5883 112.658 56.3487 112.459 56.1462C112.261 55.9436 112.025 55.7822 111.764 55.671C111.503 55.5599 111.223 55.5012 110.939 55.4984C110.656 55.4956 110.375 55.5487 110.112 55.6546Z" fill="#D4D4D8"/>
</g>
</g>
</g>
<defs>
<clipPath id="clip0_104_2007">
<rect width="167" height="193" rx="11" fill="white"/>
</clipPath>
</defs>
</svg>
''');

    final OpacityPeepholeOptimizer visitor = OpacityPeepholeOptimizer();
    final Node newNode = visitor.apply(node);
    final List<ResolvedPathNode> pathNodes =
        queryChildren<ResolvedPathNode>(newNode);

    expect(pathNodes.first.paint.fill?.color,
        const Color.fromRGBO(255, 255, 255, 0.6));
    expect(pathNodes[3].paint.fill?.color,
        const Color.fromRGBO(255, 255, 255, 0.3));
  });
}
